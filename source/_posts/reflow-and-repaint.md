---
title: DOM操作与重绘重排
date: 2017-05-01 13:27:17
tags:
  - 性能优化
---
---

#### DOM操作
使用 js 操作 DOM 的代价是昂贵的，有一个贴切的比喻，DOM 与 ECMScript 就像两座小岛，而他们之间由一个收费的桥梁连接，ECMScript 每次访问 DOM 都要“收费”。

所以DOM操作的性能优化有两点技巧：
1. 将运算尽量放在 ECMScript 一端，减少 DOM 操作
2. 对 DOM 对象进行缓存

#### 重绘与重排
当 DOM 中的元素几何属性发生变化时，就会发生重排，重排一定会触发重绘；当元素只是发生样式变化时，只会触发重绘。

**重排的代价是非常昂贵的。**

所以应该尽量避免重排的发生：
1. 对同一 DOM 元素的操作尽量写在一起，最小化重排的次数
2. 不要在会引起重排的语句中穿插 **需要返回最新布局信息** 的语句，比如 offsetTop、scrollTop、clientTop、getComputedStyle 等
3. 使用 fragment 元素，批量操作 DOM 元素时使之脱离文档流，操作完之后再一次性加入文档
4. 将需要多次触发重排的元素的 position 设置为 absolute 或 fixed，以避免触发其他元素的重排